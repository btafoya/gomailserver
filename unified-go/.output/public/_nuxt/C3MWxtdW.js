import{u as s}from"./vkYvzIJb.js";const n=()=>typeof window<"u"?localStorage.getItem("token"):null,r=()=>{const a=n();return{"Content-Type":"application/json",...a?{Authorization:`Bearer ${a}`}:{}}},l=()=>{const a=s();return{auditDomain:async(t,e)=>{const o=await fetch(`${a}/reputation/audit/${t}`,{method:"POST",headers:r(),...e?{body:JSON.stringify(e)}:{}});if(!o.ok)throw new Error("Failed to audit domain");return await o.json()},getScores:async()=>{const t=await fetch(`${a}/reputation/scores`,{method:"GET",headers:r()});if(!t.ok)throw new Error("Failed to fetch reputation scores");return(await t.json()).data||[]},getScore:async t=>{const e=await fetch(`${a}/reputation/scores/${t}`,{method:"GET",headers:r()});if(!e.ok)throw new Error("Failed to fetch domain score");return await e.json()},listCircuitBreakers:async()=>{const t=await fetch(`${a}/reputation/circuit-breakers`,{method:"GET",headers:r()});if(!t.ok)throw new Error("Failed to fetch circuit breakers");return(await t.json()).data||[]},getCircuitBreakerHistory:async t=>{const e=await fetch(`${a}/reputation/circuit-breakers/${t}/history`,{method:"GET",headers:r()});if(!e.ok)throw new Error("Failed to fetch circuit breaker history");return(await e.json()).data||[]},listAlerts:async()=>{const t=await fetch(`${a}/reputation/alerts`,{method:"GET",headers:r()});if(!t.ok)throw new Error("Failed to fetch alerts");return(await t.json()).data||[]}}};export{r as getAuthHeaders,n as getAuthToken,l as useReputationApi};
