import{u as n}from"./vkYvzIJb.js";const i=()=>typeof window<"u"?localStorage.getItem("token"):null,r=()=>{const a=i();return{"Content-Type":"application/json",...a?{Authorization:`Bearer ${a}`}:{}}},W=()=>{const a=n();return{listDMARCReports:async(t=1,e=20)=>{const o=await fetch(`${a}/reputation/dmarc/reports?page=${t}&page_size=${e}`,{method:"GET",headers:r()});if(!o.ok)throw new Error("Failed to fetch DMARC reports");return await o.json()},getDMARCReport:async t=>{const e=await fetch(`${a}/reputation/dmarc/reports/${t}`,{method:"GET",headers:r()});if(!e.ok)throw new Error("Failed to fetch DMARC report");return(await e.json()).data},getDMARCStats:async t=>{const e=await fetch(`${a}/reputation/dmarc/stats/${t}`,{method:"GET",headers:r()});if(!e.ok)throw new Error("Failed to fetch DMARC statistics");return(await e.json()).data},getDMARCActions:async()=>{const t=await fetch(`${a}/reputation/dmarc/actions`,{method:"GET",headers:r()});if(!t.ok)throw new Error("Failed to fetch DMARC actions");return(await t.json()).data||[]},exportDMARCReport:async t=>{const e=await fetch(`${a}/reputation/dmarc/reports/${t}/export`,{method:"POST",headers:r()});if(!e.ok)throw new Error("Failed to export DMARC report");return await e.blob()},listARFReports:async()=>{const t=await fetch(`${a}/reputation/arf/reports`,{method:"GET",headers:r()});if(!t.ok)throw new Error("Failed to fetch ARF reports");return(await t.json()).data||[]},getARFStats:async()=>{const t=await fetch(`${a}/reputation/arf/stats`,{method:"GET",headers:r()});if(!t.ok)throw new Error("Failed to fetch ARF statistics");return(await t.json()).data},processARFReport:async t=>{const e=await fetch(`${a}/reputation/arf/reports/${t}/process`,{method:"POST",headers:r()});if(!e.ok)throw new Error("Failed to process ARF report");return await e.json()},getPostmasterMetrics:async t=>{const e=await fetch(`${a}/reputation/external/postmaster/${t}`,{method:"GET",headers:r()});if(!e.ok)throw new Error("Failed to fetch Postmaster metrics");return(await e.json()).data},getSNDSMetrics:async t=>{const e=await fetch(`${a}/reputation/external/snds/${t}`,{method:"GET",headers:r()});if(!e.ok)throw new Error("Failed to fetch SNDS metrics");return(await e.json()).data},getExternalMetricsTrends:async(t,e=7)=>{const o=await fetch(`${a}/reputation/external/trends?domain=${t}&days=${e}`,{method:"GET",headers:r()});if(!o.ok)throw new Error("Failed to fetch external metrics trends");return(await o.json()).data},listProviderRateLimits:async()=>{const t=await fetch(`${a}/reputation/provider-limits`,{method:"GET",headers:r()});if(!t.ok)throw new Error("Failed to fetch provider rate limits");return(await t.json()).data||[]},updateProviderRateLimit:async(t,e)=>{const o=await fetch(`${a}/reputation/provider-limits/${t}`,{method:"PUT",headers:r(),body:JSON.stringify(e)});if(!o.ok)throw new Error("Failed to update provider rate limit");return(await o.json()).data},initializeProviderLimits:async t=>{const e=await fetch(`${a}/reputation/provider-limits/init/${t}`,{method:"POST",headers:r()});if(!e.ok)throw new Error("Failed to initialize provider limits");return await e.json()},resetProviderUsage:async t=>{const e=await fetch(`${a}/reputation/provider-limits/${t}/reset`,{method:"POST",headers:r()});if(!e.ok)throw new Error("Failed to reset provider usage");return await e.json()},getCustomWarmupSchedule:async t=>{const e=await fetch(`${a}/reputation/warmup/${t}`,{method:"GET",headers:r()});if(!e.ok)throw new Error("Failed to fetch custom warmup schedule");return(await e.json()).data},createCustomWarmupSchedule:async t=>{const e=await fetch(`${a}/reputation/warmup`,{method:"POST",headers:r(),body:JSON.stringify(t)});if(!e.ok)throw new Error("Failed to create custom warmup schedule");return(await e.json()).data},updateCustomWarmupSchedule:async(t,e)=>{const o=await fetch(`${a}/reputation/warmup/${t}`,{method:"PUT",headers:r(),body:JSON.stringify(e)});if(!o.ok)throw new Error("Failed to update custom warmup schedule");return(await o.json()).data},deleteCustomWarmupSchedule:async t=>{if(!(await fetch(`${a}/reputation/warmup/${t}`,{method:"DELETE",headers:r()})).ok)throw new Error("Failed to delete custom warmup schedule")},getWarmupTemplates:async()=>{const t=await fetch(`${a}/reputation/warmup/templates`,{method:"GET",headers:r()});if(!t.ok)throw new Error("Failed to fetch warmup templates");return(await t.json()).data||[]},getLatestPredictions:async()=>{const t=await fetch(`${a}/reputation/predictions/latest`,{method:"GET",headers:r()});if(!t.ok)throw new Error("Failed to fetch latest predictions");return(await t.json()).data||[]},getDomainPredictions:async t=>{const e=await fetch(`${a}/reputation/predictions/${t}`,{method:"GET",headers:r()});if(!e.ok)throw new Error("Failed to fetch domain predictions");return(await e.json()).data},generatePredictions:async t=>{const e=await fetch(`${a}/reputation/predictions/generate/${t}`,{method:"POST",headers:r()});if(!e.ok)throw new Error("Failed to generate predictions");return await e.json()},getPredictionHistory:async t=>{const e=await fetch(`${a}/reputation/predictions/${t}/history`,{method:"GET",headers:r()});if(!e.ok)throw new Error("Failed to fetch prediction history");return(await e.json()).data||[]},listPhase5Alerts:async()=>{const t=await fetch(`${a}/reputation/alerts/phase5`,{method:"GET",headers:r()});if(!t.ok)throw new Error("Failed to fetch Phase 5 alerts");return(await t.json()).data||[]},acknowledgeAlert:async t=>{const e=await fetch(`${a}/reputation/alerts/${t}/acknowledge`,{method:"POST",headers:r()});if(!e.ok)throw new Error("Failed to acknowledge alert");return await e.json()},resolveAlert:async t=>{const e=await fetch(`${a}/reputation/alerts/${t}/resolve`,{method:"POST",headers:r()});if(!e.ok)throw new Error("Failed to resolve alert");return await e.json()}}};export{r as getAuthHeaders,i as getAuthToken,W as useReputationPhase5Api};
