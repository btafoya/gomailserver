const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./C3MWxtdW.js","./vkYvzIJb.js","./D0OVFWy-.js"])))=>i.map(i=>d[i]);
import{f as W,Q as K,q as v,c,a as u,b as l,E as D,g as X,w as e,R,D as p,o as m,T as Y,d as n,F as A,G as H,t as d}from"./BUcYa01A.js";import{_ as Z}from"./Dzup3tpv.js";import{_ as h}from"./DQxZl4Gi.js";import{_ as tt}from"./TWhVIJrq.js";import{_ as et}from"./DDnXcZAG.js";import{_ as lt}from"./BAwcxMjs.js";import{_ as at}from"./CLuzgwfI.js";import"./ZLFFUBy4.js";import"./DAzf46mh.js";import"./CYi_maFl.js";import"./ChGbc9Ds.js";const nt={class:"space-y-6"},ot={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ut={class:"space-y-4"},rt=["value"],st={key:0,class:"text-center py-8 text-gray-500"},it={key:1},bt=W({__name:"index",async setup(dt){let f,g;const{listCircuitBreakers:z}=([f,g]=K(()=>R(()=>import("./C3MWxtdW.js"),__vite__mapDeps([0,1]),import.meta.url)),f=await f,g(),f),{getDomains:G}=([f,g]=K(()=>R(()=>import("./D0OVFWy-.js"),__vite__mapDeps([2,1]),import.meta.url)),f=await f,g(),f),C=v([]),w=v([]),T=v(""),F=v([]),_=v({domain:"",status:""}),y=v(!1),U=v(null),S=o=>o==="complaint"?"destructive":o==="bounce"?"warning":"default",Q=o=>new Date(o*1e3).toLocaleString(),$=o=>{const t=Date.now(),r=Math.floor((t-o*1e3)/6e4);return r>=3600?"> 1 hour":r>=1800?"> 30 minutes":"in "+r+" minutes"},k=async()=>{y.value=!0,U.value=null;try{const[o,t]=await Promise.all([z(),G()]);C.value=o.data?.filter(r=>(_.status===""||r.auto_resumed===(_.status==="resumed"))&&(_.domain===""||r.domain===_.domain)),F.value=t.data?.map(r=>r.name)||[],C.value.length===0&&T.value&&await E(T.value||"")}catch(o){U.value=o.message||"Failed to fetch circuit breakers"}finally{y.value=!1}},E=async o=>{y.value=!0,U.value=null;try{const{getCircuitBreakerHistory:t}=await R(async()=>{const{getCircuitBreakerHistory:r}=await import("./C3MWxtdW.js");return{getCircuitBreakerHistory:r}},__vite__mapDeps([0,1]),import.meta.url);w.value=await t(o)}catch(t){console.error("Failed to fetch circuit breaker history:",t)}finally{y.value=!1}},j=()=>{_.value={domain:"",status:""},k()},J=async o=>{y.value=!0;try{console.log("Manual resume requested for:",o),await new Promise(t=>setTimeout(t,500)),await k()}catch(t){U.value=t.message||"Failed to resume circuit breaker"}finally{y.value=!1}};return(o,t)=>{const r=Z,P=h,I=tt,V=p("UCardContent"),B=et,L=p("UCardTitle"),M=p("UCardHeader"),s=p("UTableHead"),x=p("UTableRow"),N=p("UTableHeader"),i=p("UTableCell"),b=lt,O=p("UTableBody"),q=at;return m(),c("div",nt,[t[23]||(t[23]=u("div",null,[u("h1",{class:"text-3xl font-bold text-gray-900 mb-6"},"Circuit Breakers"),u("p",{class:"text-gray-600"},"Monitor and manage paused domains")],-1)),l(B,{class:"mb-6"},{default:e(()=>[l(V,{class:"space-y-4"},{default:e(()=>[u("div",ot,[u("div",null,[t[3]||(t[3]=u("label",{class:"block text-sm font-medium text-gray-700"},"Filter by Domain",-1)),l(r,{modelValue:_.value.domain,"onUpdate:modelValue":t[0]||(t[0]=a=>_.value.domain=a),placeholder:"example.com",onKeyup:Y(k,["enter"])},null,8,["modelValue"])]),u("div",null,[t[5]||(t[5]=u("label",{class:"block text-sm font-medium text-gray-700"},"Filter by Status",-1)),l(P,{modelValue:_.value.status,"onUpdate:modelValue":t[1]||(t[1]=a=>_.value.status=a)},{default:e(()=>[...t[4]||(t[4]=[u("option",{value:""},"All",-1),u("option",{value:"active"},"Active",-1),u("option",{value:"paused"},"Paused",-1),u("option",{value:"resumed"},"Resumed",-1)])]),_:1},8,["modelValue"])])]),l(I,{onClick:j,variant:"outline"},{default:e(()=>[...t[6]||(t[6]=[n("Reset Filters",-1)])]),_:1})]),_:1})]),_:1}),C.value.length>0?(m(),D(B,{key:0,class:"mb-6"},{default:e(()=>[l(M,null,{default:e(()=>[l(L,null,{default:e(()=>[...t[7]||(t[7]=[n("Active Circuit Breakers",-1)])]),_:1})]),_:1}),l(V,null,{default:e(()=>[l(q,null,{default:e(()=>[l(N,null,{default:e(()=>[l(x,null,{default:e(()=>[l(s,null,{default:e(()=>[...t[8]||(t[8]=[n("Domain",-1)])]),_:1}),l(s,null,{default:e(()=>[...t[9]||(t[9]=[n("Trigger Type",-1)])]),_:1}),l(s,null,{default:e(()=>[...t[10]||(t[10]=[n("Trigger Value",-1)])]),_:1}),l(s,null,{default:e(()=>[...t[11]||(t[11]=[n("Threshold",-1)])]),_:1}),l(s,null,{default:e(()=>[...t[12]||(t[12]=[n("Paused At",-1)])]),_:1}),l(s,null,{default:e(()=>[...t[13]||(t[13]=[n("Auto-Resume In",-1)])]),_:1}),l(s,null,{default:e(()=>[...t[14]||(t[14]=[n("Actions",-1)])]),_:1})]),_:1})]),_:1}),l(O,null,{default:e(()=>[(m(!0),c(A,null,H(C.value,a=>(m(),D(x,{key:a.id},{default:e(()=>[l(i,null,{default:e(()=>[n(d(a.domain),1)]),_:2},1024),l(i,null,{default:e(()=>[l(b,{variant:S(a.trigger_type)},{default:e(()=>[n(d(a.trigger_type),1)]),_:2},1032,["variant"])]),_:2},1024),l(i,null,{default:e(()=>[n(d(a.trigger_value),1)]),_:2},1024),l(i,null,{default:e(()=>[n(d(a.threshold),1)]),_:2},1024),l(i,null,{default:e(()=>[n(d(Q(a.paused_at)),1)]),_:2},1024),l(i,null,{default:e(()=>[l(b,{variant:"outline"},{default:e(()=>[n(d($(a.paused_at)),1)]),_:2},1024)]),_:2},1024),l(i,null,{default:e(()=>[l(I,{size:"sm",onClick:mt=>J(a),variant:"outline"},{default:e(()=>[...t[15]||(t[15]=[n(" Resume ",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})):X("",!0),l(B,{class:"mb-6"},{default:e(()=>[l(M,null,{default:e(()=>[l(L,null,{default:e(()=>[...t[16]||(t[16]=[n("Circuit Breaker History",-1)])]),_:1})]),_:1}),l(V,null,{default:e(()=>[u("div",ut,[u("div",null,[t[17]||(t[17]=u("label",{class:"block text-sm font-medium text-gray-700"},"Select Domain",-1)),l(P,{modelValue:T.value,"onUpdate:modelValue":t[2]||(t[2]=a=>T.value=a),onChange:E,placeholder:"Select a domain"},{default:e(()=>[(m(!0),c(A,null,H(F.value,a=>(m(),c("option",{key:a,value:a},d(a),9,rt))),128))]),_:1},8,["modelValue"])])]),w.value.length===0?(m(),c("div",st," Select a domain to view history ")):(m(),c("div",it,[l(q,null,{default:e(()=>[l(N,null,{default:e(()=>[l(x,null,{default:e(()=>[l(s,null,{default:e(()=>[...t[18]||(t[18]=[n("Date",-1)])]),_:1}),l(s,null,{default:e(()=>[...t[19]||(t[19]=[n("Trigger Type",-1)])]),_:1}),l(s,null,{default:e(()=>[...t[20]||(t[20]=[n("Value",-1)])]),_:1}),l(s,null,{default:e(()=>[...t[21]||(t[21]=[n("Threshold",-1)])]),_:1}),l(s,null,{default:e(()=>[...t[22]||(t[22]=[n("Status",-1)])]),_:1})]),_:1})]),_:1}),l(O,null,{default:e(()=>[(m(!0),c(A,null,H(w.value,a=>(m(),D(x,{key:a.id},{default:e(()=>[l(i,null,{default:e(()=>[n(d(o.formatDate(a.created_at)),1)]),_:2},1024),l(i,null,{default:e(()=>[l(b,{variant:S(a.trigger_type)},{default:e(()=>[n(d(a.trigger_type),1)]),_:2},1032,["variant"])]),_:2},1024),l(i,null,{default:e(()=>[n(d(a.trigger_value),1)]),_:2},1024),l(i,null,{default:e(()=>[n(d(a.threshold),1)]),_:2},1024),l(i,null,{default:e(()=>[l(b,{variant:a.auto_resumed?"default":"secondary"},{default:e(()=>[n(d(a.auto_resumed?"Auto-Resumed":"Manual"),1)]),_:2},1032,["variant"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]))]),_:1})]),_:1})])}}});export{bt as default};
