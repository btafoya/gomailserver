import{f as E,q as b,p as S,c as d,a as e,b as _,t as r,P as F,g as p,M as u,N as v,O as I,n as c,F as L,G as B,D as w,o as n}from"./BUcYa01A.js";const T={class:"min-h-screen bg-gray-50 flex items-center justify-center p-4"},G={class:"max-w-2xl w-full"},Y={class:"text-center mb-8"},q={class:"flex items-center justify-center mb-4"},z={class:"mb-8"},H={class:"flex items-center justify-between mb-4"},K={class:"text-sm text-gray-500"},O={class:"h-2 bg-gray-200 rounded-full overflow-hidden"},W={class:"bg-white rounded-lg shadow-lg p-6"},$={key:0,class:"space-y-6"},J={class:"space-y-4"},Q={class:"space-y-2"},X=["disabled"],Z={class:"space-y-2"},ee=["disabled"],se={class:"flex items-center space-x-2"},te=["disabled"],le={class:"flex justify-end"},oe=["disabled"],ae={key:0},de={key:1},ne={key:1,class:"space-y-6"},ie={class:"space-y-4"},re={class:"space-y-2"},ue=["disabled"],me=["disabled"],pe={key:0},ve={key:1},ye={key:0,class:"mt-4 p-4 bg-gray-50 rounded-lg"},be={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},xe={class:"p-2 bg-white rounded border"},ce={class:"flex justify-between"},fe={class:"text-sm font-medium"},ge={class:"flex justify-end"},_e=["disabled"],we={key:0},he={key:1},Se={key:2,class:"space-y-6"},Ce={class:"space-y-4"},ke={class:"space-y-2"},Pe=["disabled"],Ae={class:"space-y-2"},De=["disabled"],Ne={class:"space-y-2"},je=["disabled"],Ve={class:"space-y-2"},Ue=["disabled"],Re={key:0,class:"mb-4 p-3 bg-red-50 border border-red-200 rounded"},Me={class:"flex justify-end"},Ee=["disabled"],Fe={key:0},Ie={key:1},Le={key:3,class:"space-y-6"},Be={class:"space-y-4"},Te={class:"space-y-2 text-sm"},Ge={class:"flex justify-between py-2 border-b"},Ye={class:"font-medium text-gray-900"},qe={class:"flex justify-between py-2 border-b"},ze={class:"font-medium text-gray-900"},He={class:"flex justify-between py-2"},Ke={class:"font-medium text-gray-900"},Oe={class:"space-y-2 text-sm"},We={class:"flex justify-between py-2 border-b"},$e={class:"font-medium text-gray-900"},Je={class:"space-y-2 text-sm"},Qe={class:"flex justify-between py-2 border-b"},Xe={class:"font-medium text-gray-900"},Ze={class:"flex justify-between py-2 border-b"},es={class:"font-medium text-gray-900"},ss={class:"flex justify-between mt-6"},ts=["disabled"],ls=["disabled"],os={key:0},as={key:1},ds={key:4,class:"text-center py-12"},ns={class:"flex justify-center mb-4"},is={class:"flex items-center justify-center"},ms=E({__name:"index",setup(rs){const a=b("system"),t=b({hostname:"",port:8980,tls_enabled:!0,domain:"",email:"",full_name:"",password:"",confirm_password:""}),l=b(!1),m=b(""),f=b(!1),x=b(null),y=S(()=>a.value==="system"?t.value.hostname.trim().length>0&&t.value.port>0:a.value==="domain"?t.value.domain.trim().length>0&&x.value!==null:a.value==="admin"?t.value.email.trim().length>0&&t.value.full_name.trim().length>0&&t.value.password.length>=8&&t.value.password===t.value.confirm_password:!1),g=()=>{a.value==="system"?a.value="domain":a.value==="domain"?a.value="admin":a.value==="admin"&&(a.value="review")},C=()=>{a.value==="review"?a.value="admin":a.value==="admin"&&(a.value="domain")},k=()=>{/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.value.email)||(m.value="Please enter a valid email address")},P=()=>{t.value.password.length<8&&(m.value="Password must be at least 8 characters")},A=()=>{t.value.password!==t.value.confirm_password&&(m.value="Passwords do not match")},D=async()=>{if(!t.value.domain){m.value="Domain is required";return}f.value=!0,m.value="",setTimeout(()=>{x.value={SPF:"PASS",DKIM:"PASS",DMARC:"PASS",rDNS:"FAIL"},f.value=!1},2e3)},N=i=>x.value?.[i]==="PASS"?"text-green-600":"text-red-600",j=i=>x.value?.[i]||"PENDING",V=async()=>{l.value=!0,m.value="";try{await new Promise(i=>setTimeout(i,2e3)),a.value="complete",setTimeout(()=>{window.location.href="/admin"},3e3)}catch(i){m.value=i instanceof Error?i.message:"Failed to complete setup"}finally{l.value=!1}},h=S(()=>["system","domain","admin","review"].indexOf(a.value)+1);return(i,s)=>{const U=w("Mail"),R=w("CheckCircle2"),M=w("Loader2");return n(),d("div",T,[e("div",G,[e("div",Y,[e("div",q,[_(U,{class:"h-12 w-12 text-blue-600"})]),s[9]||(s[9]=e("h1",{class:"text-3xl font-bold text-gray-900"}," Welcome to GoMail ",-1)),s[10]||(s[10]=e("p",{class:"text-lg text-gray-600 mt-2"}," Let's configure your mail server in a few simple steps ",-1))]),e("div",z,[e("div",H,[s[11]||(s[11]=e("span",{class:"text-sm font-medium text-gray-700"},"Setup Progress",-1)),e("span",K,"Step "+r(h.value)+" of 4",1)]),e("div",O,[e("div",{class:"h-full bg-blue-600 transition-all duration-300",style:F({width:`${h.value/4*100}%`})},null,4)])]),e("div",W,[a.value==="system"?(n(),d("div",$,[s[18]||(s[18]=e("h2",{class:"text-2xl font-bold text-gray-900"},"System Configuration",-1)),s[19]||(s[19]=e("p",{class:"text-gray-600 mt-2"},"Configure your mail server settings",-1)),e("div",J,[e("div",Q,[s[12]||(s[12]=e("label",{class:"block text-sm font-medium text-gray-700"},"Server Hostname",-1)),u(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.value.hostname=o),type:"text",placeholder:"mail.example.com",disabled:l.value,class:"w-full px-3 py-2 border border-gray-300 rounded-md"},null,8,X),[[v,t.value.hostname]]),s[13]||(s[13]=e("p",{class:"text-xs text-gray-500 mt-1"}," The public hostname of your mail server ",-1))]),e("div",Z,[s[14]||(s[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"API Port",-1)),u(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>t.value.port=o),type:"number",placeholder:"8980",disabled:l.value,class:"w-full px-3 py-2 border border-gray-300 rounded-md"},null,8,ee),[[v,t.value.port]]),s[15]||(s[15]=e("p",{class:"text-xs text-gray-500 mt-1"}," Port for API and Web UI (default: 8980) ",-1))]),e("div",se,[u(e("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.value.tls_enabled=o),type:"checkbox",id:"tls",disabled:l.value,class:"h-4 w-4 text-blue-600 rounded"},null,8,te),[[I,t.value.tls_enabled]]),s[16]||(s[16]=e("label",{for:"tls",class:"text-sm font-medium text-gray-700"}," Enable TLS/SSL ",-1)),s[17]||(s[17]=e("p",{class:"text-xs text-gray-500"}," Enable automatic SSL certificate management ",-1))])]),e("div",le,[e("button",{onClick:g,disabled:!y.value||l.value,class:c(["px-4 py-2 bg-blue-600 text-white rounded-md font-medium",!y.value||l.value?"opacity-50 cursor-not-allowed":"hover:bg-blue-700"])},[l.value?(n(),d("span",de,"Configuring...")):(n(),d("span",ae,"Next: Domain Setup"))],10,oe)])])):p("",!0),a.value==="domain"?(n(),d("div",ne,[s[23]||(s[23]=e("h2",{class:"text-2xl font-bold text-gray-900"},"Domain Setup",-1)),s[24]||(s[24]=e("p",{class:"text-gray-600 mt-2"},"Configure your primary domain",-1)),e("div",ie,[e("div",re,[s[20]||(s[20]=e("label",{class:"block text-sm font-medium text-gray-700"},"Domain Name",-1)),u(e("input",{"onUpdate:modelValue":s[3]||(s[3]=o=>t.value.domain=o),type:"text",placeholder:"example.com",disabled:l.value,onBlur:s[4]||(s[4]=(...o)=>i.validateDomain&&i.validateDomain(...o)),class:"w-full px-3 py-2 border border-gray-300 rounded-md"},null,40,ue),[[v,t.value.domain]]),s[21]||(s[21]=e("p",{class:"text-xs text-gray-500 mt-1"}," Your primary domain (e.g., mail.example.com) ",-1))]),e("button",{type:"button",onClick:D,disabled:l.value||!t.value.domain,class:c(["px-4 py-2 border border-gray-300 rounded-md font-medium",!l.value&&t.value.domain?"hover:bg-gray-50":"opacity-50 cursor-not-allowed"])},[f.value?(n(),d("span",ve,"Checking DNS...")):(n(),d("span",pe,"Run DNS Audit"))],10,me)]),x.value?(n(),d("div",ye,[s[22]||(s[22]=e("h3",{class:"text-lg font-semibold mb-3"},"Audit Results",-1)),e("div",be,[(n(),d(L,null,B(["SPF","DKIM","DMARC","rDNS"],o=>e("div",{key:o},[e("div",xe,[e("div",ce,[e("span",fe,r(o),1),e("span",{class:c(["text-xs font-bold",N(o)])},r(j(o)),3)])])])),64))])])):p("",!0),e("div",ge,[e("button",{onClick:g,disabled:!y.value||l.value,class:c(["px-4 py-2 bg-blue-600 text-white rounded-md font-medium",!y.value||l.value?"opacity-50 cursor-not-allowed":"hover:bg-blue-700"])},[l.value?(n(),d("span",he,"Saving...")):(n(),d("span",we,"Next: Create Admin User"))],10,_e)])])):p("",!0),a.value==="admin"?(n(),d("div",Se,[s[33]||(s[33]=e("h2",{class:"text-2xl font-bold text-gray-900"},"Create Admin User",-1)),s[34]||(s[34]=e("p",{class:"text-gray-600 mt-2"},"Create your first administrator account",-1)),e("div",Ce,[e("div",ke,[s[25]||(s[25]=e("label",{class:"block text-sm font-medium text-gray-700"},"Email Address",-1)),u(e("input",{"onUpdate:modelValue":s[5]||(s[5]=o=>t.value.email=o),type:"email",placeholder:"admin@example.com",disabled:l.value,onBlur:k,class:"w-full px-3 py-2 border border-gray-300 rounded-md"},null,40,Pe),[[v,t.value.email]]),s[26]||(s[26]=e("p",{class:"text-xs text-gray-500 mt-1"}," Administrator email address ",-1))]),e("div",Ae,[s[27]||(s[27]=e("label",{class:"block text-sm font-medium text-gray-700"},"Full Name",-1)),u(e("input",{"onUpdate:modelValue":s[6]||(s[6]=o=>t.value.full_name=o),type:"text",placeholder:"Admin User",disabled:l.value,class:"w-full px-3 py-2 border border-gray-300 rounded-md"},null,8,De),[[v,t.value.full_name]]),s[28]||(s[28]=e("p",{class:"text-xs text-gray-500 mt-1"}," Administrator display name ",-1))]),e("div",Ne,[s[29]||(s[29]=e("label",{class:"block text-sm font-medium text-gray-700"},"Password",-1)),u(e("input",{"onUpdate:modelValue":s[7]||(s[7]=o=>t.value.password=o),type:"password",placeholder:"••••••••••••",disabled:l.value,onBlur:P,class:"w-full px-3 py-2 border border-gray-300 rounded-md"},null,40,je),[[v,t.value.password]]),s[30]||(s[30]=e("p",{class:"text-xs text-gray-500 mt-1"}," Minimum 8 characters, recommended to include uppercase, lowercase, numbers, and symbols ",-1))]),e("div",Ve,[s[31]||(s[31]=e("label",{class:"block text-sm font-medium text-gray-700"},"Confirm Password",-1)),u(e("input",{"onUpdate:modelValue":s[8]||(s[8]=o=>t.value.confirm_password=o),type:"password",placeholder:"••••••••••••",disabled:l.value,onBlur:A,class:"w-full px-3 py-2 border border-gray-300 rounded-md"},null,40,Ue),[[v,t.value.confirm_password]]),s[32]||(s[32]=e("p",{class:"text-xs text-gray-500 mt-1"}," Re-enter password to confirm ",-1))])]),i.error?(n(),d("div",Re,r(i.error),1)):p("",!0),e("div",Me,[e("button",{onClick:g,disabled:!y.value||l.value,class:c(["px-4 py-2 bg-blue-600 text-white rounded-md font-medium",!y.value||l.value?"opacity-50 cursor-not-allowed":"hover:bg-blue-700"])},[l.value?(n(),d("span",Ie,"Creating user...")):(n(),d("span",Fe,"Next: Review Configuration"))],10,Ee)])])):p("",!0),a.value==="review"?(n(),d("div",Le,[s[44]||(s[44]=e("h2",{class:"text-2xl font-bold text-gray-900"},"Review & Complete",-1)),s[45]||(s[45]=e("p",{class:"text-gray-600 mt-2"},"Review your configuration before completing setup",-1)),e("div",Be,[e("div",null,[s[38]||(s[38]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-3"},"System Settings",-1)),e("div",Te,[e("div",Ge,[s[35]||(s[35]=e("span",{class:"text-gray-600"},"Server Hostname:",-1)),e("span",Ye,r(t.value.hostname||"-"),1)]),e("div",qe,[s[36]||(s[36]=e("span",{class:"text-gray-600"},"API Port:",-1)),e("span",ze,r(t.value.port||"-"),1)]),e("div",He,[s[37]||(s[37]=e("span",{class:"text-gray-600"},"TLS Enabled:",-1)),e("span",Ke,r(t.value.tls_enabled?"Yes":"No"),1)])])]),e("div",null,[s[40]||(s[40]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-3"},"Domain Configuration",-1)),e("div",Oe,[e("div",We,[s[39]||(s[39]=e("span",{class:"text-gray-600"},"Primary Domain:",-1)),e("span",$e,r(t.value.domain||"-"),1)])])]),e("div",null,[s[43]||(s[43]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-3"},"Admin User",-1)),e("div",Je,[e("div",Qe,[s[41]||(s[41]=e("span",{class:"text-gray-600"},"Email:",-1)),e("span",Xe,r(t.value.email||"-"),1)]),e("div",Ze,[s[42]||(s[42]=e("span",{class:"text-gray-600"},"Full Name:",-1)),e("span",es,r(t.value.full_name||"-"),1)])])])]),e("div",ss,[e("button",{onClick:C,disabled:l.value,class:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50"}," Previous ",8,ts),e("button",{onClick:V,disabled:l.value,class:"px-4 py-2 bg-blue-600 text-white rounded-md font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"},[l.value?(n(),d("span",as,"Completing...")):(n(),d("span",os,"Complete Setup"))],8,ls)])])):p("",!0),a.value==="complete"?(n(),d("div",ds,[e("div",ns,[_(R,{class:"h-16 w-16 text-green-500"})]),s[46]||(s[46]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-2"}," Setup Complete! ",-1)),s[47]||(s[47]=e("p",{class:"text-gray-600 mb-6"}," Your mail server has been configured successfully. Redirecting to admin dashboard... ",-1)),e("div",is,[_(M,{class:"h-6 w-6 animate-spin text-blue-600"})])])):p("",!0)])])])}}});export{ms as default};
