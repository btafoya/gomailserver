import{_ as De}from"./TWhVIJrq.js";import{_ as ke}from"./DQxZl4Gi.js";import{_ as Ie}from"./DDnXcZAG.js";import{_ as ze}from"./BAwcxMjs.js";import{_ as Ve,a as Le}from"./CLuzgwfI.js";import{_ as Te}from"./Dzup3tpv.js";import{_ as Se}from"./BaZuvFz9.js";import{useReputationPhase5Api as Re}from"./DUWfgsoE.js";import{R as h}from"./D0UlAAtA.js";import{P as Pe}from"./CSm6nba8.js";import{L as V}from"./BZDPJRid.js";import{S as Fe}from"./CxqfMMs1.js";import{P as Ae}from"./-lBS8n-0.js";import{c as Ee}from"./BDTT5SEM.js";import{I as Be}from"./CuaCQJ6X.js";import{C as He}from"./98tBQm4Q.js";import{f as Me,q as m,p as ee,y as Oe,c as b,a as n,b as t,E as _,g as L,w as l,D as i,o as u,d as o,C as d,F as O,G as j,t as c,n as te}from"./BUcYa01A.js";import"./DAzf46mh.js";import"./CYi_maFl.js";import"./ZLFFUBy4.js";import"./ChGbc9Ds.js";import"./vkYvzIJb.js";const je=Ee("RotateCcwIcon",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Ne={class:"space-y-6"},$e={class:"flex items-center justify-between"},qe={class:"flex gap-2"},Ge={class:"flex items-end gap-4"},Ke={class:"flex-1 space-y-2"},We={key:0,class:"flex items-center justify-center py-12"},Ye={key:1,class:"text-center py-12"},Je={class:"space-y-1"},Qe={class:"flex justify-between text-xs"},Xe={class:"text-sm"},Ze={class:"flex justify-end gap-2"},he={class:"space-y-4 py-4"},et={class:"space-y-2"},tt={class:"space-y-2"},lt={class:"space-y-2"},at={class:"space-y-4 py-4"},nt={class:"space-y-2"},Vt=Me({__name:"index",setup(ot){const{listProviderRateLimits:le,updateProviderRateLimit:ae,initializeProviderLimits:ne,resetProviderUsage:oe}=Re(),C=m([]),U=m(!1),r=m(!1),p=m(null),z=m(""),w=m(!1),D=m(!1),k=m(!1),f=m({id:0,domain:"",provider:"",daily_limit:0}),x=m({domain:""}),T=m(null),N=ee(()=>z.value?C.value.filter(s=>s.domain===z.value):C.value),S=ee(()=>[...new Set(C.value.map(e=>e.domain))].sort()),I=async()=>{U.value=!0,p.value=null;try{C.value=await le()}catch(s){p.value=s.message||"Failed to load provider limits"}finally{U.value=!1}},se=()=>{},ie=s=>{f.value={id:s.id,domain:s.domain,provider:s.provider,daily_limit:s.daily_limit},w.value=!0},ue=async()=>{if(f.value.id){r.value=!0,p.value=null;try{await ae(f.value.id,{daily_limit:f.value.daily_limit}),w.value=!1,await I()}catch(s){p.value=s.message||"Failed to update provider limit"}finally{r.value=!1}}},re=()=>{x.value.domain=S.value[0]||"",D.value=!0},de=async()=>{if(x.value.domain){r.value=!0,p.value=null;try{await ne(x.value.domain),D.value=!1,await I()}catch(s){p.value=s.message||"Failed to initialize provider limits"}finally{r.value=!1}}},me=s=>{T.value=s,k.value=!0},pe=async()=>{if(T.value){r.value=!0,p.value=null;try{await oe(T.value),k.value=!1,await I()}catch(s){p.value=s.message||"Failed to reset provider usage"}finally{r.value=!1}}},fe=async()=>{await I()},ve=s=>new Date(s).toLocaleString(),_e=s=>s>=90?"bg-red-500":s>=75?"bg-yellow-500":"bg-green-500",ce=s=>s>=90?"text-red-600":s>=75?"text-yellow-600":"text-green-600",ge=s=>s>=90?"Critical":s>=75?"Warning":"OK";return Oe(()=>{I()}),(s,e)=>{const v=De,$=i("USelectValue"),q=i("USelectTrigger"),R=i("USelectItem"),G=i("USelectContent"),K=ke,W=i("UCardContent"),Y=Ie,g=i("UTableHead"),J=i("UTableRow"),ye=i("UTableHeader"),y=i("UTableCell"),Ue=ze,xe=Le,be=i("UTableBody"),Ce=Ve,P=i("UIDialogTitle"),F=i("UIDialogDescription"),A=i("UIDialogHeader"),E=Te,B=i("UIDialogFooter"),H=i("UIDialogContent"),M=i("UIDialog"),Q=i("UAlertTitle"),X=i("UAlertDescription"),Z=Se;return u(),b("div",Ne,[n("div",$e,[e[13]||(e[13]=n("div",null,[n("h1",{class:"text-2xl font-bold"},"Provider Rate Limits"),n("p",{class:"text-sm text-gray-500 mt-1"}," Manage sending limits and utilization for major email providers ")],-1)),n("div",qe,[t(v,{variant:"outline",onClick:fe,disabled:U.value},{default:l(()=>[U.value?(u(),_(d(h),{key:0,class:"h-4 w-4 animate-spin mr-2"})):(u(),_(d(h),{key:1,class:"h-4 w-4 mr-2"})),e[11]||(e[11]=o(" Refresh ",-1))]),_:1},8,["disabled"]),t(v,{onClick:re,disabled:U.value},{default:l(()=>[t(d(Pe),{class:"h-4 w-4 mr-2"}),e[12]||(e[12]=o(" Initialize Defaults ",-1))]),_:1},8,["disabled"])])]),t(Y,null,{default:l(()=>[t(W,{class:"pt-6"},{default:l(()=>[n("div",Ge,[n("div",Ke,[e[15]||(e[15]=n("label",{class:"text-sm font-medium"},"Filter by Domain",-1)),t(K,{modelValue:z.value,"onUpdate:modelValue":[e[0]||(e[0]=a=>z.value=a),se]},{default:l(()=>[t(q,null,{default:l(()=>[t($,{placeholder:"All domains"})]),_:1}),t(G,null,{default:l(()=>[t(R,{value:""},{default:l(()=>[...e[14]||(e[14]=[o("All domains",-1)])]),_:1}),(u(!0),b(O,null,j(S.value,a=>(u(),_(R,{key:a,value:a},{default:l(()=>[o(c(a),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1}),t(Y,null,{default:l(()=>[t(W,{class:"pt-6"},{default:l(()=>[U.value&&C.value.length===0?(u(),b("div",We,[t(d(V),{class:"h-8 w-8 animate-spin text-gray-400"})])):N.value.length===0?(u(),b("div",Ye,[t(d(Fe),{class:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e[16]||(e[16]=n("p",{class:"text-gray-500"},"No provider limits configured",-1)),e[17]||(e[17]=n("p",{class:"text-sm text-gray-400 mt-1"},' Click "Initialize Defaults" to set up limits for your domains ',-1))])):(u(),_(Ce,{key:2},{default:l(()=>[t(ye,null,{default:l(()=>[t(J,null,{default:l(()=>[t(g,null,{default:l(()=>[...e[18]||(e[18]=[o("Domain",-1)])]),_:1}),t(g,null,{default:l(()=>[...e[19]||(e[19]=[o("Provider",-1)])]),_:1}),t(g,null,{default:l(()=>[...e[20]||(e[20]=[o("Daily Limit",-1)])]),_:1}),t(g,null,{default:l(()=>[...e[21]||(e[21]=[o("Current Usage",-1)])]),_:1}),t(g,null,{default:l(()=>[...e[22]||(e[22]=[o("Utilization",-1)])]),_:1}),t(g,null,{default:l(()=>[...e[23]||(e[23]=[o("Last Reset",-1)])]),_:1}),t(g,{class:"text-right"},{default:l(()=>[...e[24]||(e[24]=[o("Actions",-1)])]),_:1})]),_:1})]),_:1}),t(be,null,{default:l(()=>[(u(!0),b(O,null,j(N.value,a=>(u(),_(J,{key:a.id},{default:l(()=>[t(y,{class:"font-medium"},{default:l(()=>[o(c(a.domain),1)]),_:2},1024),t(y,null,{default:l(()=>[t(Ue,{variant:"outline"},{default:l(()=>[o(c(a.provider),1)]),_:2},1024)]),_:2},1024),t(y,null,{default:l(()=>[o(c(a.daily_limit.toLocaleString()),1)]),_:2},1024),t(y,null,{default:l(()=>[o(c(a.current_usage.toLocaleString()),1)]),_:2},1024),t(y,{class:"w-48"},{default:l(()=>[n("div",Je,[t(xe,{value:a.utilization_percentage,class:te(_e(a.utilization_percentage))},null,8,["value","class"]),n("div",Qe,[n("span",null,c(a.utilization_percentage.toFixed(1))+"%",1),n("span",{class:te(ce(a.utilization_percentage))},c(ge(a.utilization_percentage)),3)])])]),_:2},1024),t(y,null,{default:l(()=>[n("div",Xe,c(ve(a.last_reset)),1)]),_:2},1024),t(y,{class:"text-right"},{default:l(()=>[n("div",Ze,[t(v,{variant:"ghost",size:"sm",onClick:we=>ie(a),title:"Edit limit"},{default:l(()=>[t(d(Ae),{class:"h-4 w-4"})]),_:1},8,["onClick"]),t(v,{variant:"ghost",size:"sm",onClick:we=>me(a.id),title:"Reset usage"},{default:l(()=>[t(d(je),{class:"h-4 w-4"})]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}))]),_:1})]),_:1}),t(M,{open:w.value,"onUpdate:open":e[5]||(e[5]=a=>w.value=a)},{default:l(()=>[t(H,{class:"sm:max-w-md"},{default:l(()=>[t(A,null,{default:l(()=>[t(P,null,{default:l(()=>[...e[25]||(e[25]=[o("Edit Provider Limit",-1)])]),_:1}),t(F,null,{default:l(()=>[...e[26]||(e[26]=[o(" Update the daily sending limit for this provider. ",-1)])]),_:1})]),_:1}),n("div",he,[n("div",et,[e[27]||(e[27]=n("label",{class:"text-sm font-medium"},"Domain",-1)),t(E,{modelValue:f.value.domain,"onUpdate:modelValue":e[1]||(e[1]=a=>f.value.domain=a),disabled:""},null,8,["modelValue"])]),n("div",tt,[e[28]||(e[28]=n("label",{class:"text-sm font-medium"},"Provider",-1)),t(E,{modelValue:f.value.provider,"onUpdate:modelValue":e[2]||(e[2]=a=>f.value.provider=a),disabled:""},null,8,["modelValue"])]),n("div",lt,[e[29]||(e[29]=n("label",{class:"text-sm font-medium"},"Daily Limit",-1)),t(E,{modelValue:f.value.daily_limit,"onUpdate:modelValue":e[3]||(e[3]=a=>f.value.daily_limit=a),modelModifiers:{number:!0},type:"number",min:"1",placeholder:"Enter daily limit"},null,8,["modelValue"]),e[30]||(e[30]=n("p",{class:"text-xs text-gray-500"}," Maximum number of emails that can be sent to this provider per day ",-1))])]),t(B,null,{default:l(()=>[t(v,{variant:"outline",onClick:e[4]||(e[4]=a=>w.value=!1)},{default:l(()=>[...e[31]||(e[31]=[o(" Cancel ",-1)])]),_:1}),t(v,{onClick:ue,disabled:r.value},{default:l(()=>[r.value?(u(),_(d(V),{key:0,class:"h-4 w-4 animate-spin mr-2"})):L("",!0),e[32]||(e[32]=o(" Save Changes ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),t(M,{open:D.value,"onUpdate:open":e[8]||(e[8]=a=>D.value=a)},{default:l(()=>[t(H,{class:"sm:max-w-md"},{default:l(()=>[t(A,null,{default:l(()=>[t(P,null,{default:l(()=>[...e[33]||(e[33]=[o("Initialize Provider Limits",-1)])]),_:1}),t(F,null,{default:l(()=>[...e[34]||(e[34]=[o(" Set default rate limits for all providers on selected domain. ",-1)])]),_:1})]),_:1}),n("div",at,[n("div",nt,[e[35]||(e[35]=n("label",{class:"text-sm font-medium"},"Domain",-1)),t(K,{modelValue:x.value.domain,"onUpdate:modelValue":e[6]||(e[6]=a=>x.value.domain=a)},{default:l(()=>[t(q,null,{default:l(()=>[t($,{placeholder:"Select a domain"})]),_:1}),t(G,null,{default:l(()=>[(u(!0),b(O,null,j(S.value,a=>(u(),_(R,{key:a,value:a},{default:l(()=>[o(c(a),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),t(Z,null,{default:l(()=>[t(d(Be),{class:"h-4 w-4"}),t(Q,null,{default:l(()=>[...e[36]||(e[36]=[o("Default Limits",-1)])]),_:1}),t(X,null,{default:l(()=>[...e[37]||(e[37]=[n("div",{class:"space-y-1 text-sm"},[n("p",null,[n("strong",null,"Gmail:"),o(" 2,000 emails/day")]),n("p",null,[n("strong",null,"Outlook:"),o(" 10,000 emails/day")]),n("p",null,[n("strong",null,"Yahoo:"),o(" 500 emails/day")]),n("p",null,[n("strong",null,"Others:"),o(" 5,000 emails/day")])],-1)])]),_:1})]),_:1})]),t(B,null,{default:l(()=>[t(v,{variant:"outline",onClick:e[7]||(e[7]=a=>D.value=!1)},{default:l(()=>[...e[38]||(e[38]=[o(" Cancel ",-1)])]),_:1}),t(v,{onClick:de,disabled:r.value||!x.value.domain},{default:l(()=>[r.value?(u(),_(d(V),{key:0,class:"h-4 w-4 animate-spin mr-2"})):L("",!0),e[39]||(e[39]=o(" Initialize ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),t(M,{open:k.value,"onUpdate:open":e[10]||(e[10]=a=>k.value=a)},{default:l(()=>[t(H,{class:"sm:max-w-md"},{default:l(()=>[t(A,null,{default:l(()=>[t(P,null,{default:l(()=>[...e[40]||(e[40]=[o("Reset Usage",-1)])]),_:1}),t(F,null,{default:l(()=>[...e[41]||(e[41]=[o(" Are you sure you want to reset the usage counter for this provider? The daily limit will remain unchanged, but the current usage will be set to 0. ",-1)])]),_:1})]),_:1}),t(B,null,{default:l(()=>[t(v,{variant:"outline",onClick:e[9]||(e[9]=a=>k.value=!1)},{default:l(()=>[...e[42]||(e[42]=[o(" Cancel ",-1)])]),_:1}),t(v,{variant:"destructive",onClick:pe,disabled:r.value},{default:l(()=>[r.value?(u(),_(d(V),{key:0,class:"h-4 w-4 animate-spin mr-2"})):L("",!0),e[43]||(e[43]=o(" Reset Usage ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),p.value?(u(),_(Z,{key:0,variant:"destructive"},{default:l(()=>[t(d(He),{class:"h-4 w-4"}),t(Q,null,{default:l(()=>[...e[44]||(e[44]=[o("Error",-1)])]),_:1}),t(X,null,{default:l(()=>[o(c(p.value),1)]),_:1})]),_:1})):L("",!0)])}}});export{Vt as default};
