import{_ as U}from"./TWhVIJrq.js";import{u as E}from"./vkYvzIJb.js";import{f as $,q as y,y as C,c as d,a as e,b as v,w as T,t as p,F as A,G as S,o as i,d as j,C as B,J as b}from"./BUcYa01A.js";import{P as F}from"./CSm6nba8.js";import"./DAzf46mh.js";import"./CYi_maFl.js";import"./BDTT5SEM.js";const N=()=>typeof window>"u"?null:localStorage.getItem("token"),u=()=>{const h=N();return{"Content-Type":"application/json",...h?{Authorization:`Bearer ${h}`}:{}}},P=()=>E(),m=P(),D=()=>({getUsers:async()=>{const t=await fetch(`${m}/users`,{method:"GET",headers:u()});if(!t.ok)throw new Error("Failed to fetch users");return(await t.json()).data||[]},getUser:async t=>{const s=await fetch(`${m}/users/${t}`,{method:"GET",headers:u()});if(!s.ok)throw new Error("Failed to fetch user");return(await s.json()).data},createUser:async t=>{const s=await fetch(`${m}/users`,{method:"POST",headers:u(),body:JSON.stringify(t)});if(!s.ok){const g=await s.json();throw new Error(g.message||"Failed to create user")}return(await s.json()).data},updateUser:async(t,s)=>{const n=await fetch(`${m}/users/${t}`,{method:"PUT",headers:u(),body:JSON.stringify(s)});if(!n.ok){const r=await n.json();throw new Error(r.message||"Failed to update user")}return(await n.json()).data},deleteUser:async t=>{if(!(await fetch(`${m}/users/${t}`,{method:"DELETE",headers:u()})).ok)throw new Error("Failed to delete user")},resetPassword:async(t,s)=>{if(!(await fetch(`${m}/users/${t}/password`,{method:"POST",headers:u(),body:JSON.stringify({new_password:s})})).ok)throw new Error("Failed to reset password")}}),O={class:"flex-1 p-4 md:p-8"},J={class:"flex items-center justify-between mb-6"},L={key:0,class:"text-center py-12"},G={key:1,class:"bg-destructive/10 text-destructive px-4 py-3 rounded-lg"},V={key:2,class:"text-center py-12 bg-card rounded-lg border border-border"},I={key:3,class:"bg-card rounded-lg border border-border overflow-hidden"},q={class:"w-full"},z={class:"px-6 py-4 text-sm text-foreground"},H={class:"px-6 py-4 text-sm text-foreground"},M={class:"px-6 py-4 text-sm text-muted-foreground"},K={class:"px-6 py-4 text-sm text-muted-foreground"},Q={class:"px-6 py-4 text-sm"},R=["onClick"],W=["onClick"],re=$({__name:"index",setup(h){const{getUsers:w,deleteUser:_}=D(),l=y([]),x=y(!1),c=y(null),t=async()=>{x.value=!0,c.value=null;try{l.value=await w()}catch(r){c.value=r.message}finally{x.value=!1}},s=async(r,o)=>{if(confirm(`Are you sure you want to delete user "${o}"? This action cannot be undone.`))try{await _(r),l.value=l.value.filter(f=>f.id!==r)}catch(f){c.value=f.message}},n=()=>{b("/admin/users/create")},g=r=>{b(`/admin/users/${r}`)};return C(()=>{t()}),(r,o)=>{const f=U;return i(),d("div",O,[e("div",J,[o[1]||(o[1]=e("h2",{class:"text-3xl font-bold tracking-tight"},"Users",-1)),v(f,{onClick:n},{default:T(()=>[v(B(F),{class:"mr-2 h-4 w-4"}),o[0]||(o[0]=j(" Create User ",-1))]),_:1})]),x.value?(i(),d("div",L,[...o[2]||(o[2]=[e("p",{class:"text-muted-foreground"},"Loading users...",-1)])])):c.value?(i(),d("div",G," Error loading users: "+p(c.value),1)):l.value.length===0?(i(),d("div",V,[...o[3]||(o[3]=[e("p",{class:"text-muted-foreground"},"No users found. Create your first user to get started.",-1)])])):(i(),d("div",I,[e("table",q,[o[4]||(o[4]=e("thead",{class:"bg-muted/50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Email"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Name"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Domain"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Created"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Actions")])],-1)),e("tbody",null,[(i(!0),d(A,null,S(l.value,a=>(i(),d("tr",{key:a.id,class:"border-t border-border"},[e("td",z,p(a.email),1),e("td",H,p(a.full_name||a.email),1),e("td",M,p(a.domain),1),e("td",K,p(new Date(a.created_at).toLocaleDateString()),1),e("td",Q,[e("button",{onClick:k=>g(a.id),class:"text-primary hover:underline mr-2"}," Edit ",8,R),e("button",{onClick:k=>s(a.id,a.email),class:"text-red-600 hover:underline"}," Delete ",8,W)])]))),128))])])]))])}}});export{re as default};
